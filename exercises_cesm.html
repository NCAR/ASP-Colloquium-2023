

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Community Earth System Model &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'exercises_cesm';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Weather Research and Forecasting Model (WRF)" href="exercises_wrf.html" />
    <link rel="prev" title="Computing Environments" href="exercises_envs.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/ncar_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/ncar_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    2023 ASP Summer Colloquium
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="information.html">Local Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="before_arrival.html">Before you arrive</a></li>
<li class="toctree-l1"><a class="reference internal" href="schedule.html">Colloquium Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="presenters.html">Presenters</a></li>
<li class="toctree-l1"><a class="reference internal" href="students.html">Student Attendees</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="exercises.html">Exercises</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="exercises_envs.html">Computing Environments</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Community Earth System Model</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="exercises_wrf.html">Weather Research and Forecasting Model (WRF)</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="exercises_wrf_test.html">WRF Test Case Study: Major Snowstorm December 16-17, 2020</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercises_wrf_sens.html">WRF PBL Focused Sensitivity Experiments</a></li>

</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="exercises_class.html">Chemistry Land-surface Atmosphere Soil Slab model (CLASS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="exercises_obs.html">Observation Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="diagnostics.html">Diagnostics</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fexercises_cesm.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/exercises_cesm.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Community Earth System Model</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#with-these-exercises-we-hope-for-you-to-achieve">With these exercises we hope for you to achieve</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#description-of-model-cases-and-configurations">Description of Model Cases and Configurations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#test-run-of-cesm-cases">Test run of CESM cases</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="section" id="community-earth-system-model">
<h1><a class="reference external" href="https://www.cesm.ucar.edu/">Community Earth System Model</a><a class="headerlink" href="#community-earth-system-model" title="Permalink to this headline">#</a></h1>
<p>The aim of this notebook is guide the creation, simulation and analyisis of CESM global, multi-annual simulations.</p>
<div class="section" id="with-these-exercises-we-hope-for-you-to-achieve">
<h2>With these exercises we hope for you to achieve<a class="headerlink" href="#with-these-exercises-we-hope-for-you-to-achieve" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>An understanding of the workflow for a climate model</p></li>
<li><p>The ability to perform basic sensitivity experiments</p></li>
<li><p>An understanding of how boundary layers vary in different climate regimes and how they may be sensitive to different boundary layer scheme formulations</p></li>
<li><p>A baseline diagnosis of multiple CESM experiments</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To the greatest extent possible we will follow the <a class="reference external" href="https://github.com/NCAR/CESM-Tutorial">CESM tutorial</a> for setting up, submitting, running and processing output from simulations. In particular what follows below is a much abbreviated version of the more comprehensive <a class="reference external" href="https://ncar.github.io/CESM-Tutorial/notebooks/basics/cesm_workflow.html">CESM workflow</a></p>
</div>
</div>
<div class="section" id="description-of-model-cases-and-configurations">
<h2>Description of Model Cases and Configurations<a class="headerlink" href="#description-of-model-cases-and-configurations" title="Permalink to this headline">#</a></h2>
<p>The experiments we will perform with CESM will comprise an atmosphere model, land model and simplified (thermodynamic-only) sea-ice model over a global domain. An ocean model will not be used, instead being replace by fix or prescribed values of Sea Surface Temperature (SSTs). We will use a relatively course horizontal resolution, nomilly 2 degress in both latitude and longitude.</p>
</div>
<div class="section" id="test-run-of-cesm-cases">
<h2>Test run of CESM cases<a class="headerlink" href="#test-run-of-cesm-cases" title="Permalink to this headline">#</a></h2>
<p>Please follow the <code class="docutils literal notranslate"><span class="pre">basic</span></code> test cases from the CESM tutorial <a class="reference external" href="https://ncar.github.io/CESM-Tutorial/notebooks/basics/exercises/first_B1850.html">here</a>. These are a little different from what we wish to run: namely we will run F2000climo compsets: Atmopshere and land with fixed SST as described above. A summary of the steps with slight modification for our purposes follow.</p>
<ol class="arabic simple">
<li><p>Setup my workspace</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd /glade/work/$USER/ASP2023
mkdir cesm_cases
mkdir cesm_code
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Download CESM code base using <code class="docutils literal notranslate"><span class="pre">git</span></code> and checkout the required code branch</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd /glade/work/$USER/ASP2023/cesm_code
git clone https://github.com/ESCOMP/CESM.git my_cesm_code
cd my_cesm_code
git checkout release-cesm2.1.4
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Pull in external model code</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">manage_externals</span><span class="o">/</span><span class="n">checkout_externals</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Find the cesm scripts directory</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">cime</span><span class="o">/</span><span class="n">scripts</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Create a new case (experiment) with all the baseline information you need for a run with prescribed SSTs and year 2000 climatology (<code class="docutils literal notranslate"><span class="pre">COMPSET=F2000climo</span></code>) at a relatively course resolution of 2 degrees (<code class="docutils literal notranslate"><span class="pre">RES=f19_f19_mg17</span></code>). Maybe <code class="docutils literal notranslate"><span class="pre">CASE='cesm_control'</span></code> (will refer to <code class="docutils literal notranslate"><span class="pre">$CASE</span></code> below)
Therefore:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>./create_newcase --case /glade/work/$USER/ASP2023/cesm_cases/cesm_control --res f19_f19_mg17 --compset F2000climo --run-unsupported --project NASP0013
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The configuration is not officially supported, but it is fine for our use here.<br />
The project code <code class="docutils literal notranslate"><span class="pre">NASP0013</span></code> is the ASP2023 computing account key that will be used for submitted CESM jobs. Type <code class="docutils literal notranslate"><span class="pre">groups</span></code> in a terminal to make sure you are part of this group.</p>
</div>
<ol class="arabic simple" start="6">
<li><p>Case directory
This command should have a set up a series of scripts, files and directories in your <code class="docutils literal notranslate"><span class="pre">case</span></code> directory</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd /glade/work/$USER/ASP2023/cesm_cases/$CASE
</pre></div>
</div>
<p>The experimental still requires the following default setup to be performed</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">case</span><span class="o">.</span><span class="n">setup</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Model build and compilation
You main model build which, includes the <code class="docutils literal notranslate"><span class="pre">compile</span></code>, now needs to be performed. The <code class="docutils literal notranslate"><span class="pre">qcmd</span></code> indiactes that the task will be pushed of the <code class="docutils literal notranslate"><span class="pre">login</span></code> made you are currently working on, and submitted to a <code class="docutils literal notranslate"><span class="pre">compute</span></code> to avoid congestion on the often busy login nodes.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qcmd</span> <span class="o">--</span> <span class="o">./</span><span class="n">case</span><span class="o">.</span><span class="n">build</span>
</pre></div>
</div>
<p>The build will take around <strong>10 minutes</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can check job status using the command<br />
<code class="docutils literal notranslate"><span class="pre">qstat</span> <span class="pre">-u</span> <span class="pre">$USER</span></code></p>
</div>
<p>If it completes with no errors, the last line of screen output should be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MODEL</span> <span class="n">BUILD</span> <span class="n">HAS</span> <span class="n">FINISHED</span> <span class="n">SUCCESSFULLY</span>
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li><p>Determine run length
With the default setup you have built it is configured for a default run period of 5 days (very short). You can tell this by running<code class="docutils literal notranslate"><span class="pre">[xml]()</span></code> interogation scripts in the the case directory that operate on the xml files e.g.,<code class="docutils literal notranslate"><span class="pre">env_case.xml</span></code>. Try and poke around in these files as they contain parameters controling multiple aspects of the run configuration.</p></li>
</ol>
<p>Key variables for run length are STOP_N and STOP_OPTION. Find the descriptions with the following (from your case directory)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">xmlquery</span> <span class="o">--</span><span class="n">description</span> <span class="n">STOP_N</span>
<span class="o">./</span><span class="n">xmlquery</span> <span class="o">--</span><span class="n">description</span> <span class="n">STOP_OPTION</span>

<span class="o">./</span><span class="n">xmlquery</span> <span class="n">STOP_N</span>
<span class="o">./</span><span class="n">xmlquery</span> <span class="n">STOP_OPTION</span>
</pre></div>
</div>
<p>Hopefully it is straight forward from this information to determine that the model will run for 5 <code class="docutils literal notranslate"><span class="pre">=STOP_N</span></code> days <code class="docutils literal notranslate"><span class="pre">=STOP_OPTION</span></code>.
This is the default setup so we don’t have to chnage anything else. Note
that we will be running for multiple years in your sensitivity experiments.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To ensure we use the right project key and we utilise our reseved compute nodes include the following
<code class="docutils literal notranslate"><span class="pre">./xmlchange</span> <span class="pre">--force</span> <span class="pre">JOB_QUEUE=S2036390</span></code>
<code class="docutils literal notranslate"><span class="pre">./xmlchange</span> <span class="pre">PROJECT=NASP0013</span></code></p>
</div>
<ol class="arabic simple" start="8">
<li><p>Submit a test run
This short <code class="docutils literal notranslate"><span class="pre">out</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">box</span> <span class="pre">configuration</span></code> is ready to run.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">case</span><span class="o">.</span><span class="n">submit</span>
</pre></div>
</div>
<p>If the submit is successful the last two lines of output should look something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Submitted</span> <span class="n">job</span> <span class="n">case</span><span class="o">.</span><span class="n">run</span> <span class="k">with</span> <span class="nb">id</span> <span class="mf">1988240.</span><span class="n">chadmin1</span><span class="o">.</span><span class="n">ib0</span><span class="o">.</span><span class="n">cheyenne</span><span class="o">.</span><span class="n">ucar</span><span class="o">.</span><span class="n">edu</span>
<span class="n">Submitted</span> <span class="n">job</span> <span class="n">case</span><span class="o">.</span><span class="n">st_archive</span> <span class="k">with</span> <span class="nb">id</span> <span class="mf">1988241.</span><span class="n">chadmin1</span><span class="o">.</span><span class="n">ib0</span><span class="o">.</span><span class="n">cheyenne</span><span class="o">.</span><span class="n">ucar</span><span class="o">.</span><span class="n">edu</span>
</pre></div>
</div>
<p>These contain the job ids seprately for the model simulations <code class="docutils literal notranslate"><span class="pre">case.run</span></code> and for post completion data archiving <code class="docutils literal notranslate"><span class="pre">case.st_archive</span></code> and will help you idenitfy the jos when you query their status in the queue.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>./qstat -u $USER
</pre></div>
</div>
<p>If you get in the queue this job should complete in a matter of minutes. When you query the queue and it lists the above job numbers still, the run is still in progress. If there is now output then the job may have <code class="docutils literal notranslate"><span class="pre">completed</span></code> or <code class="docutils literal notranslate"><span class="pre">crashed</span></code>.
To see if the run finished successfully examine the tail of the run output file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tail</span> <span class="n">run</span><span class="o">.&lt;</span><span class="n">job</span> <span class="n">name</span><span class="o">&gt;.</span><span class="n">o</span><span class="o">&lt;</span><span class="n">job</span> <span class="nb">id</span> <span class="c1">#&gt; (e.g. like  run.cesm_control.o1988240&gt;</span>
</pre></div>
</div>
<p>Near the end you should see</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MODEL</span> <span class="n">EXECUTION</span> <span class="n">HAS</span> <span class="n">FINISHED</span>
</pre></div>
</div>
<p>A quick check of you run directory will show you all the output that is produced from this experiment</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd /glade/scratch/$USER/$CASE/run
</pre></div>
</div>
<p>No output yet..</p>
<p>If the run was successful then…</p>
<ol class="arabic simple" start="9">
<li><p>Submit a Longer Run</p></li>
</ol>
<p>Again use the <code class="docutils literal notranslate"><span class="pre">xml</span></code> commands to query the <code class="docutils literal notranslate"><span class="pre">case</span> <span class="pre">xml</span></code> files and change the values</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd /glade/work/$USER/ASP2023/cesm_cases/$CASE
./xmlchange STOP_OPTION=nmonths
./xmlchange STOP_N=1
</pre></div>
</div>
<p>This will run for 1 month. Now simply submit the job again.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">case</span><span class="o">.</span><span class="n">submit</span>
</pre></div>
</div>
<p>If successful (see above check method) then check the run directory for output files</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd /glade/scratch/$USER/archive/$CASE/atm/hist
</pre></div>
</div>
<p>The output or <code class="docutils literal notranslate"><span class="pre">history</span></code> files are moved here at the the end of each run and will have the form</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$CASE.cam.h0.0001.01.nc
</pre></div>
</div>
<p>This means that a <code class="docutils literal notranslate"><span class="pre">netcdf</span></code> file with monthly averaged data was produced for January in the first year of the run.
Take a look at the contents</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ncdump -h $CASE.cam.h0.0001.01.nc | less
ncview $CASE.cam.h0.0001.01.nc
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Plot the 2-m Temperature <code class="docutils literal notranslate"><span class="pre">TREFHT</span></code> and the boundary layer depth <code class="docutils literal notranslate"><span class="pre">PBLH</span></code>
<img alt="" src="_images/cam_t2m.png" />
<img alt="" src="_images/cam_pblh.png" /></p>
</div>
<ol class="arabic simple" start="10">
<li><p>Submit a Climate Run</p></li>
</ol>
<p>You are now ready to run a longer simulation for 3 years.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd /glade/work/$USER/ASP2023/cesm_cases/$CASE
./xmlchange STOP_OPTION=nmonths
./xmlchange STOP_N=36
</pre></div>
</div>
<p>Repeat submission as above.</p>
<ol class="arabic simple" start="11">
<li><p>Extended case: Climate change simulation</p></li>
</ol>
<p>We will run a second simulation that modifies the Sea Surface Temperature (SST) to be <code class="docutils literal notranslate"><span class="pre">SST.new=SST.f2000+4K</span></code> this is a basleine climate sensitivty experiment used in <code class="docutils literal notranslate"><span class="pre">CMIP</span></code> protocals.
See <code class="docutils literal notranslate"><span class="pre">Cecile's</span></code> presentation for details on how to chnage to the +4K SST dataset</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">glade</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">rneale</span><span class="o">/</span><span class="n">ASP2023</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">sst_HadOIBl_bc_1</span><span class="mf">.9</span><span class="n">x2</span><span class="mf">.5</span><span class="n">_clim_SST</span><span class="o">+</span><span class="mi">4</span><span class="n">K</span><span class="o">.</span><span class="n">c230718</span><span class="o">.</span><span class="n">nc</span>
</pre></div>
</div>
<ol class="arabic simple" start="12">
<li><p>Create climatologies</p></li>
</ol>
<p>If you run for more than one year with CESM it is useful to produce <code class="docutils literal notranslate"><span class="pre">climatologies</span></code></p>
<p>Let’s move to the archive directory where all your monthly mean history <code class="docutils literal notranslate"><span class="pre">h0</span></code> output is for a particular case (e.g., <code class="docutils literal notranslate"><span class="pre">$CASE</span></code> - cesm_control for our control here)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd /glade/scratch/$USER/archive/$CASE
</pre></div>
</div>
<p>Create a directory for <code class="docutils literal notranslate"><span class="pre">climatology</span></code> data</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">climo</span>
<span class="n">cd</span> <span class="n">climo</span>
</pre></div>
</div>
<p>For each month create a single averaged file using <code class="docutils literal notranslate"><span class="pre">ncea</span></code> commands (make sure you have input the command <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span> <span class="pre">nco</span></code>. Below <code class="docutils literal notranslate"><span class="pre">XX</span></code> is run for each separate month of the year; 01 through 12</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ncea ../atm/hist/$CASE.cam.h0.????-XX.nc $CESM_XX_climo.nc
</pre></div>
</div>
<p>These are then the climatologies you can use in your analysis.
Feel free to use either these suggested <a class="reference internal" href="diagnostics.html"><span class="doc std std-doc">python-based</span></a> or remind yourself of the other <a class="reference internal" href="exercises_envs.html"><span class="doc std std-doc">diagnostic tools</span></a> to interogate the data.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "jbooks"
        },
        kernelOptions: {
            name: "jbooks",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'jbooks'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="exercises_envs.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Computing Environments</p>
      </div>
    </a>
    <a class="right-next"
       href="exercises_wrf.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Weather Research and Forecasting Model (WRF)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#with-these-exercises-we-hope-for-you-to-achieve">With these exercises we hope for you to achieve</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#description-of-model-cases-and-configurations">Description of Model Cases and Configurations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#test-run-of-cesm-cases">Test run of CESM cases</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>